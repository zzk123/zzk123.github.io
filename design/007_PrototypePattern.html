<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>原型模式 | Koala &#39;s blog</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="欢迎来到我的博客">
    <link rel="preload" href="/assets/css/0.styles.0dca6718.css" as="style"><link rel="preload" href="/assets/js/app.193c9b61.js" as="script"><link rel="preload" href="/assets/js/2.be286493.js" as="script"><link rel="preload" href="/assets/js/23.2e9ea85a.js" as="script"><link rel="prefetch" href="/assets/js/10.d195f939.js"><link rel="prefetch" href="/assets/js/11.dd42e2a6.js"><link rel="prefetch" href="/assets/js/12.ee2c872c.js"><link rel="prefetch" href="/assets/js/13.788181fe.js"><link rel="prefetch" href="/assets/js/14.923b40d7.js"><link rel="prefetch" href="/assets/js/15.be1e8f2a.js"><link rel="prefetch" href="/assets/js/16.a5861f2e.js"><link rel="prefetch" href="/assets/js/17.0ca1cca8.js"><link rel="prefetch" href="/assets/js/18.3552af88.js"><link rel="prefetch" href="/assets/js/19.d0b598dd.js"><link rel="prefetch" href="/assets/js/20.312fba46.js"><link rel="prefetch" href="/assets/js/21.de99e5de.js"><link rel="prefetch" href="/assets/js/22.4cb1ef09.js"><link rel="prefetch" href="/assets/js/24.1cd100b8.js"><link rel="prefetch" href="/assets/js/25.c17ed571.js"><link rel="prefetch" href="/assets/js/26.cee42a14.js"><link rel="prefetch" href="/assets/js/27.34b9e8bb.js"><link rel="prefetch" href="/assets/js/28.a0fd1666.js"><link rel="prefetch" href="/assets/js/29.cc16a8ba.js"><link rel="prefetch" href="/assets/js/3.e2b53d75.js"><link rel="prefetch" href="/assets/js/30.4b4a9808.js"><link rel="prefetch" href="/assets/js/31.55d17ac2.js"><link rel="prefetch" href="/assets/js/32.e6285297.js"><link rel="prefetch" href="/assets/js/33.2cf9fcd0.js"><link rel="prefetch" href="/assets/js/34.549b5096.js"><link rel="prefetch" href="/assets/js/35.fd8c8f14.js"><link rel="prefetch" href="/assets/js/36.db162c08.js"><link rel="prefetch" href="/assets/js/37.f105831d.js"><link rel="prefetch" href="/assets/js/38.d42b82e0.js"><link rel="prefetch" href="/assets/js/39.eb81783f.js"><link rel="prefetch" href="/assets/js/4.2837b6be.js"><link rel="prefetch" href="/assets/js/40.87c4c789.js"><link rel="prefetch" href="/assets/js/41.fc9b4279.js"><link rel="prefetch" href="/assets/js/42.c9148681.js"><link rel="prefetch" href="/assets/js/43.dbe26f4f.js"><link rel="prefetch" href="/assets/js/44.b1d85a5c.js"><link rel="prefetch" href="/assets/js/45.5a1e6a7a.js"><link rel="prefetch" href="/assets/js/46.bd963e4a.js"><link rel="prefetch" href="/assets/js/47.f6e86edc.js"><link rel="prefetch" href="/assets/js/48.bdbc5c65.js"><link rel="prefetch" href="/assets/js/49.65ae461d.js"><link rel="prefetch" href="/assets/js/5.3f71247d.js"><link rel="prefetch" href="/assets/js/50.66be60b2.js"><link rel="prefetch" href="/assets/js/51.42b1c641.js"><link rel="prefetch" href="/assets/js/52.bb9f5b94.js"><link rel="prefetch" href="/assets/js/53.3ed95f43.js"><link rel="prefetch" href="/assets/js/54.b989fa99.js"><link rel="prefetch" href="/assets/js/55.7799c2bd.js"><link rel="prefetch" href="/assets/js/56.95e3d2fa.js"><link rel="prefetch" href="/assets/js/57.47649eef.js"><link rel="prefetch" href="/assets/js/58.c3ce9734.js"><link rel="prefetch" href="/assets/js/59.1e092fb4.js"><link rel="prefetch" href="/assets/js/6.ba15ebf3.js"><link rel="prefetch" href="/assets/js/60.ae57b5f2.js"><link rel="prefetch" href="/assets/js/61.68ecf247.js"><link rel="prefetch" href="/assets/js/62.42a2fc04.js"><link rel="prefetch" href="/assets/js/63.819b8db9.js"><link rel="prefetch" href="/assets/js/64.8034f4d3.js"><link rel="prefetch" href="/assets/js/65.fa291912.js"><link rel="prefetch" href="/assets/js/66.3db4dcf7.js"><link rel="prefetch" href="/assets/js/67.a66d7e55.js"><link rel="prefetch" href="/assets/js/68.cbaf17d3.js"><link rel="prefetch" href="/assets/js/7.6f9d368d.js"><link rel="prefetch" href="/assets/js/8.516fa0e1.js"><link rel="prefetch" href="/assets/js/9.f1946ce5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0dca6718.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container custom-page-class"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">Koala 's blog</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          Home
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/design/" class="router-link-active">
          设计模式
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/algorithm/">
          算法相关
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          java相关
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/design/001_Preface.html" class="sidebar-link">前言</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>创建者模式</span> <span class="arrow down"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/002_CreativePattern.html" class="sidebar-link">介绍</a></li><li><a href="/design/003_SingletonPattern.html" class="sidebar-link">单例模式</a></li><li><a href="/design/004_SimpleFactoryPattern.html" class="sidebar-link">简单工厂模式</a></li><li><a href="/design/005_FactoryMethodPattern.html" class="sidebar-link">工厂方法模式</a></li><li><a href="/design/006_AbstractFactoryPattern.html" class="sidebar-link">抽象工厂模式</a></li><li><a href="/design/007_PrototypePattern.html" class="active sidebar-link">原型模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#结构图" class="sidebar-link">结构图</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#实现方法" class="sidebar-link">实现方法</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#工作周报的快速创建" class="sidebar-link">工作周报的快速创建</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#浅克隆和深克隆" class="sidebar-link">浅克隆和深克隆</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#缺点" class="sidebar-link">缺点</a></li><li class="sidebar-sub-header"><a href="/design/007_PrototypePattern.html#使用场景" class="sidebar-link">使用场景</a></li></ul></li><li><a href="/design/008_BuilderPattern.html" class="sidebar-link">建造者模式</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>结构性模式</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>行为性模式</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h2 id="定义"><a href="#定义" aria-hidden="true" class="header-anchor">#</a> 定义</h2> <blockquote><p>原型模式（Prototype Pattern）： 使用原型实例指定创建对象的种类，并且通过克隆这些原型创建新的对象。原型模式是一种对象创建型模式</p></blockquote> <p>原型模式的工作原理就是，将一个原型对象传给那个要发动创建的对象，这个要发动创建的对象通过请求原型对象克隆自己来实现创建过程。由于在软件系统中经常会遇到创建多个相同或者相似对象的情况，因此原型模式在真实开发中的使用频率还是非常高的。原型模式是一种‘另类’的创建型模式，创建克隆对象的工厂就是原型类的本身，工厂方法由克隆方法实现</p> <p>需要注意的是，通过克隆方法所创建的对象是全新的对象，它们在内存中拥有新的地址；通常，对克隆所产生的对象进行的修改不会对原型对象造成任何影响，每一个克隆对象都是相互独立的；通过不同的方式对克隆对象进行修改以后，可以得到一系列相似但不完全相同的对象</p> <h2 id="结构图"><a href="#结构图" aria-hidden="true" class="header-anchor">#</a> 结构图</h2> <p><a data-fancybox="" title="结构图" href="/pic/design/10asFDZ.png"><img src="/pic/design/10asFDZ.png" alt="结构图"></a></p> <ol><li><p><strong>Prototype（抽象原型类）</strong>：它是声明克隆方法的接口，是所有具体原型类的公共父类，可以是抽象类也可以是接口，甚至还可以是具体实现类</p></li> <li><p><strong>ConcretePrototype（具体原型类）</strong>：它实现在抽象原型类中声明的克隆方法，在克隆方法中返回自己的一个克隆对象</p></li> <li><p><strong>Client（客户类）</strong>：让一个原型对象克隆自身从而创建一个新的对象，在客户类中只需要直接实例化或通过工厂方法等方式创建一个原型对象，再通过调用该对象的克隆方法即可得到多个相同的对象，由于客户类针对抽象原型类Prototype编程，因此用户可以根据需要选择具体原型类，系统具有较好的可扩展性，增加或更换具体原型类都很方便</p></li></ol> <h2 id="实现方法"><a href="#实现方法" aria-hidden="true" class="header-anchor">#</a> 实现方法</h2> <h3 id="_1-通用实现方法"><a href="#_1-通用实现方法" aria-hidden="true" class="header-anchor">#</a> 1. 通用实现方法</h3> <p>在具体原型类的克隆方法中实例化一个与自身类型相同的对象并将其返回，并将相关的参数传入新创建的对象中，保证它们的成员变量相同</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	class ConcretePrototype implements Prototype<span class="token punctuation">{</span>
		
		private String attr<span class="token punctuation">;</span> //成员变量

		public void setAttr<span class="token punctuation">(</span>String attr<span class="token punctuation">)</span><span class="token punctuation">{</span>
			this.attr <span class="token operator">=</span> attr<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		public String getAttr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> this.attr<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		public Prototype clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			Prototype prototype <span class="token operator">=</span> new ConcretePrototype<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	//创建新的对象
			prototype.setAttr<span class="token punctuation">(</span>this.attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> prototype<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-java语言提供的clone-方法"><a href="#_2-java语言提供的clone-方法" aria-hidden="true" class="header-anchor">#</a> 2. Java语言提供的clone()方法</h3> <p>在java中可以直接使用Object提供的clone方法，不过要使用该方法先要先实现一个标识接口Cloneable，表示该java类支持被复制</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	class ConcretePrototype implements Cloneable<span class="token punctuation">{</span>
		
		<span class="token punctuation">..</span>.
		public Prototype clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			Object object <span class="token operator">=</span> null<span class="token punctuation">;</span>
			try<span class="token punctuation">{</span>
				object <span class="token operator">=</span> super.clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>catch<span class="token punctuation">(</span>CloneNotSupportedException exception<span class="token punctuation">)</span><span class="token punctuation">{</span>
				System.err.println<span class="token punctuation">(</span><span class="token string">&quot;Not support cloneable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span>Prototype<span class="token punctuation">)</span>object<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token punctuation">..</span>.
	<span class="token punctuation">}</span> 
</code></pre></div><p>在客户端创建原型对象和克隆对象</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	Prototype obj1 <span class="token operator">=</span> new ConcretePrototype<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	Prototype obj2 <span class="token operator">=</span> obj1.clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>一般，java中的clone()方法满足：</p> <ol><li><p>对任何对象x，都有x.clone()！= x，即克隆对象与原型对象不是同一个对象</p></li> <li><p>对任何对象x，都有x.clone().getClass() == x.getClass(),即克隆对象和原型对象的类型一样</p></li> <li><p>如果对象x的equals()方法定义恰当，那么x.clone().equals(x)应该成立</p></li></ol> <h2 id="工作周报的快速创建"><a href="#工作周报的快速创建" aria-hidden="true" class="header-anchor">#</a> 工作周报的快速创建</h2> <h3 id="结构图-2"><a href="#结构图-2" aria-hidden="true" class="header-anchor">#</a> 结构图</h3> <p><a data-fancybox="" title="结构图" href="/pic/design/3sCZnju.png"><img src="/pic/design/3sCZnju.png" alt="结构图"></a></p> <p>WeeklyLog充当具体原型类，Object类充当抽象原型类，clone()方法为原型方法</p> <h3 id="代码实现"><a href="#代码实现" aria-hidden="true" class="header-anchor">#</a> 代码实现</h3> <p><strong>WeeklyLog：具体原型类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	//实现标识接口Cloneable，表示java类支持复制
	public class WeeklyLog implements Cloneable <span class="token punctuation">{</span>
		private String name<span class="token punctuation">;</span>
		private String <span class="token function">date</span><span class="token punctuation">;</span>
		private String content<span class="token punctuation">;</span>
		public String getName<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> name<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		public void setName<span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			this.name <span class="token operator">=</span> name<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		public String getDate<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token function">date</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		public void setDate<span class="token punctuation">(</span>String date<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			this.date <span class="token operator">=</span> <span class="token function">date</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		public String getContent<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> content<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		public void setContent<span class="token punctuation">(</span>String content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			this.content <span class="token operator">=</span> content<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		//克隆方法clone<span class="token punctuation">(</span><span class="token punctuation">)</span>,此处使用java语言提供的克隆机制
		public WeeklyLog clone<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			Object obj <span class="token operator">=</span> null<span class="token punctuation">;</span>
			try <span class="token punctuation">{</span>
				obj <span class="token operator">=</span> super.clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> <span class="token punctuation">(</span>WeeklyLog<span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>catch <span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				System.out.println<span class="token punctuation">(</span><span class="token string">&quot;不支持复制！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> null<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>客户端测试</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class Client <span class="token punctuation">{</span>
		public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			WeeklyLog log_previous <span class="token operator">=</span> new WeeklyLog<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			log_previous.setName<span class="token punctuation">(</span><span class="token string">&quot;张无忌&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			log_previous.setDate<span class="token punctuation">(</span><span class="token string">&quot;第12周&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			log_previous.setContent<span class="token punctuation">(</span><span class="token string">&quot;这周工作很忙&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			WeeklyLog log_new<span class="token punctuation">;</span>
			log_new <span class="token operator">=</span> log_previous.clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="浅克隆和深克隆"><a href="#浅克隆和深克隆" aria-hidden="true" class="header-anchor">#</a> 浅克隆和深克隆</h2> <p>在java语言中，数据类型分为值类型（基本数据类型）和引用类型，值类型包括int,double,byte,boolean,char等简单数据类型，引用类型包括类，接口，数组等复杂类型。浅克隆和深克隆的主要区别在于是否支持引用类型的成员变量的复制</p> <h3 id="浅克隆（shallow-clone）"><a href="#浅克隆（shallow-clone）" aria-hidden="true" class="header-anchor">#</a> 浅克隆（Shallow Clone）</h3> <p>在浅克隆中，如果原型对象的成员变量是值类型，将复制一份给克隆对象；如果原型对象的成员变量是引用类型，则将引用对象的地址复制一份给克隆对象，也就是原型对象和克隆对象的成员变量指向相同的内存地址。简单来说，当对象被复制时，只复制它本身和其中包含的值类型的成员变量，而引用类型的成员对象并没有被复制</p> <h3 id="深克隆（deep-clone）"><a href="#深克隆（deep-clone）" aria-hidden="true" class="header-anchor">#</a> 深克隆（Deep Clone）</h3> <p>在深克隆中，无论原型对象的成员变量是值类型还是引用类型，都将复制一份给克隆对象，深克隆将原型对象的所有引用对象也复制一份给克隆对象。简单来说，在深克隆中，除了对象本身被复制外，对象所包含的所有成员变量也将被复制</p> <p>在Java语言中，如果需要实现深克隆，可以通过序列化（Serialization）等方法来实现。序列化就是将对象写到流的过程，写到流中的对象是原有对象的一个复制品，而原对象仍然存于内存中。通过序列化实现的复制不仅可以复制对象本身，而且还可以复制其引用的成员对象，因此通过序列化对象写到一个流中，再从流中将其读出来，可以实现深克隆。</p> <h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2> <p>原型模式作为一种快速创建大量相同或相似对象的方式，在软件开发中应用较为广泛，很多软件提供的复制(Ctrl + C)和粘贴(Ctrl + V)操作就是原型模式的典型应用</p> <h2 id="优点"><a href="#优点" aria-hidden="true" class="header-anchor">#</a> 优点</h2> <ol><li><p>当创建新的对象实例较为复杂时，使用原型模式可以简化对象的创建过程，通过复制一个已有实例可以提高新实例的创建效率</p></li> <li><p>扩展性较好，由于在原型模式中提供了抽象原型类，在客户端可以针对抽象原型类进行编程，而将具体原型类写在配置文件中，增加或减少具体原型类对原有系统都没有任何影响</p></li> <li><p>原型模式提供了简化的创建结构。工厂方法模式常常需要由一个与产品类等级结构相同的工厂等级结构，而原型模式就不需要这样，原型模式中产品的复制是通过封装在原型类中的克隆方法实现的，无须专门的工厂类来创建产品</p></li> <li><p>可以使用深克隆的方式保存对象的状态。使用原型模式将对象赋值一份并将其状态保存起来，以便在需要的时候使用。</p></li></ol> <h2 id="缺点"><a href="#缺点" aria-hidden="true" class="header-anchor">#</a> 缺点</h2> <ol><li><p>需要为每一个类配备一个克隆方法，而且该克隆方法位于一个类的内部，当对已有的类进行改造时，需要修改源代码，违背了开闭原则</p></li> <li><p>在实现深克隆时需要编写较为复杂的代码，而且当对象之间存在多重的嵌套引用时，为了实现深克隆，每一层对象对应的类都必须支持深克隆，实现起来可能会比较麻烦</p></li></ol> <h2 id="使用场景"><a href="#使用场景" aria-hidden="true" class="header-anchor">#</a> 使用场景</h2> <ol><li><p>创建新对象成本较大(例如初始化需要占用较长的时间，占用太对的CPU资源或网络资源)，新的对象可以通过原型模式对已有对象进行复制来获得，如果是相似对象，则可以对其成员变量稍作修改</p></li> <li><p>如果系统要保存对象的状态，而对象的状态变化很小，或者对象本身占用内存较少时，可以使用原型模式来配合备忘录模式来实现</p></li> <li><p>需要避免使用分层次的工厂类来创建分层次的对象，并且类的实例对象只有一个或很少的几个组合状态，通过复制原型对象得到新实例可能比使用构造函数创建一个新实例更加方便</p></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/22/2020, 12:20:37 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/design/006_AbstractFactoryPattern.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        抽象工厂模式
      </a></span> <span class="next"><a href="/design/008_BuilderPattern.html">
        建造者模式
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.193c9b61.js" defer></script><script src="/assets/js/2.be286493.js" defer></script><script src="/assets/js/23.2e9ea85a.js" defer></script>
  </body>
</html>