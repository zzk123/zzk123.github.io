<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>模板方法模式 | Koala &#39;s blog</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="欢迎来到我的博客">
    <link rel="preload" href="/assets/css/0.styles.0dca6718.css" as="style"><link rel="preload" href="/assets/js/app.193c9b61.js" as="script"><link rel="preload" href="/assets/js/2.be286493.js" as="script"><link rel="preload" href="/assets/js/43.dbe26f4f.js" as="script"><link rel="prefetch" href="/assets/js/10.d195f939.js"><link rel="prefetch" href="/assets/js/11.dd42e2a6.js"><link rel="prefetch" href="/assets/js/12.ee2c872c.js"><link rel="prefetch" href="/assets/js/13.788181fe.js"><link rel="prefetch" href="/assets/js/14.923b40d7.js"><link rel="prefetch" href="/assets/js/15.be1e8f2a.js"><link rel="prefetch" href="/assets/js/16.a5861f2e.js"><link rel="prefetch" href="/assets/js/17.0ca1cca8.js"><link rel="prefetch" href="/assets/js/18.3552af88.js"><link rel="prefetch" href="/assets/js/19.d0b598dd.js"><link rel="prefetch" href="/assets/js/20.312fba46.js"><link rel="prefetch" href="/assets/js/21.de99e5de.js"><link rel="prefetch" href="/assets/js/22.4cb1ef09.js"><link rel="prefetch" href="/assets/js/23.2e9ea85a.js"><link rel="prefetch" href="/assets/js/24.1cd100b8.js"><link rel="prefetch" href="/assets/js/25.c17ed571.js"><link rel="prefetch" href="/assets/js/26.cee42a14.js"><link rel="prefetch" href="/assets/js/27.34b9e8bb.js"><link rel="prefetch" href="/assets/js/28.a0fd1666.js"><link rel="prefetch" href="/assets/js/29.cc16a8ba.js"><link rel="prefetch" href="/assets/js/3.e2b53d75.js"><link rel="prefetch" href="/assets/js/30.4b4a9808.js"><link rel="prefetch" href="/assets/js/31.55d17ac2.js"><link rel="prefetch" href="/assets/js/32.e6285297.js"><link rel="prefetch" href="/assets/js/33.2cf9fcd0.js"><link rel="prefetch" href="/assets/js/34.549b5096.js"><link rel="prefetch" href="/assets/js/35.fd8c8f14.js"><link rel="prefetch" href="/assets/js/36.db162c08.js"><link rel="prefetch" href="/assets/js/37.f105831d.js"><link rel="prefetch" href="/assets/js/38.d42b82e0.js"><link rel="prefetch" href="/assets/js/39.eb81783f.js"><link rel="prefetch" href="/assets/js/4.2837b6be.js"><link rel="prefetch" href="/assets/js/40.87c4c789.js"><link rel="prefetch" href="/assets/js/41.fc9b4279.js"><link rel="prefetch" href="/assets/js/42.c9148681.js"><link rel="prefetch" href="/assets/js/44.b1d85a5c.js"><link rel="prefetch" href="/assets/js/45.5a1e6a7a.js"><link rel="prefetch" href="/assets/js/46.bd963e4a.js"><link rel="prefetch" href="/assets/js/47.f6e86edc.js"><link rel="prefetch" href="/assets/js/48.bdbc5c65.js"><link rel="prefetch" href="/assets/js/49.65ae461d.js"><link rel="prefetch" href="/assets/js/5.3f71247d.js"><link rel="prefetch" href="/assets/js/50.66be60b2.js"><link rel="prefetch" href="/assets/js/51.42b1c641.js"><link rel="prefetch" href="/assets/js/52.bb9f5b94.js"><link rel="prefetch" href="/assets/js/53.3ed95f43.js"><link rel="prefetch" href="/assets/js/54.b989fa99.js"><link rel="prefetch" href="/assets/js/55.7799c2bd.js"><link rel="prefetch" href="/assets/js/56.95e3d2fa.js"><link rel="prefetch" href="/assets/js/57.47649eef.js"><link rel="prefetch" href="/assets/js/58.c3ce9734.js"><link rel="prefetch" href="/assets/js/59.1e092fb4.js"><link rel="prefetch" href="/assets/js/6.ba15ebf3.js"><link rel="prefetch" href="/assets/js/60.ae57b5f2.js"><link rel="prefetch" href="/assets/js/61.68ecf247.js"><link rel="prefetch" href="/assets/js/62.42a2fc04.js"><link rel="prefetch" href="/assets/js/63.819b8db9.js"><link rel="prefetch" href="/assets/js/64.8034f4d3.js"><link rel="prefetch" href="/assets/js/65.fa291912.js"><link rel="prefetch" href="/assets/js/66.3db4dcf7.js"><link rel="prefetch" href="/assets/js/67.a66d7e55.js"><link rel="prefetch" href="/assets/js/68.cbaf17d3.js"><link rel="prefetch" href="/assets/js/7.6f9d368d.js"><link rel="prefetch" href="/assets/js/8.516fa0e1.js"><link rel="prefetch" href="/assets/js/9.f1946ce5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0dca6718.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container custom-page-class"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">Koala 's blog</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          Home
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/design/" class="router-link-active">
          设计模式
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/algorithm/">
          算法相关
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          java相关
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/design/001_Preface.html" class="sidebar-link">前言</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>创建者模式</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>结构性模式</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>行为性模式</span> <span class="arrow down"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/017_BehavioralPattern.html" class="sidebar-link">介绍</a></li><li><a href="/design/018_ChainofResponsibilityPattern.html" class="sidebar-link">职责链模式</a></li><li><a href="/design/019_CommandPattern.html" class="sidebar-link">命令模式</a></li><li><a href="/design/020_InterpreterPattern.html" class="sidebar-link">解释器模式</a></li><li><a href="/design/021_MediatorPattern.html" class="sidebar-link">中介者模式</a></li><li><a href="/design/022_MementoPattern.html" class="sidebar-link">备忘录模式</a></li><li><a href="/design/023_IteratorPattern.html" class="sidebar-link">迭代器模式</a></li><li><a href="/design/024_ObserverPattern.html" class="sidebar-link">观察者模式</a></li><li><a href="/design/025_StatePattern.html" class="sidebar-link">状态模式</a></li><li><a href="/design/026_StrategyPattern.html" class="sidebar-link">策略模式</a></li><li><a href="/design/027_Template_Method_Pattern.html" class="active sidebar-link">模板方法模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#示意图" class="sidebar-link">示意图</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#模板方法和基本方法" class="sidebar-link">模板方法和基本方法</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#实例：银行利息计算模块" class="sidebar-link">实例：银行利息计算模块</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#钩子方法的使用" class="sidebar-link">钩子方法的使用</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#实例：数据图表的实现" class="sidebar-link">实例：数据图表的实现</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#主要优点" class="sidebar-link">主要优点</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#主要缺点" class="sidebar-link">主要缺点</a></li><li class="sidebar-sub-header"><a href="/design/027_Template_Method_Pattern.html#适用场景" class="sidebar-link">适用场景</a></li></ul></li><li><a href="/design/028_VisitorPattern.html" class="sidebar-link">访问者模式</a></li></ul></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h2 id="概述"><a href="#概述" aria-hidden="true" class="header-anchor">#</a> 概述</h2> <p>模板方法模式是结构最简单的行为型设计模式，在其结构中只存在父类与子类之间的继承关系。通过使用模板方法模式，可以将一些复杂流程的实现步骤封装在一系列基本方法中，在抽象父类中提供一个称之为模板方法的方法来定义这些基本方法的执行次序，而通过其子类来覆盖某些步骤，从而使得相同的算法框架可以有不同的执行结果。模板方法模式提供了一个模板方法来定义算法框架，而某些具体步骤的实现可以在其子类中完成。</p> <h2 id="定义"><a href="#定义" aria-hidden="true" class="header-anchor">#</a> 定义</h2> <blockquote><p>模板方法模式（Template Method Pattern）：定义一个操作中算法的框架，而将一些步骤延迟到子类中，模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。模板方法是一种类行为型模式。</p></blockquote> <h2 id="示意图"><a href="#示意图" aria-hidden="true" class="header-anchor">#</a> 示意图</h2> <p><a data-fancybox="" title="结构图" href="/pic/design/uigCAO0.png"><img src="/pic/design/uigCAO0.png" alt="结构图"></a></p> <ol><li><p><strong>AbstractClass（抽象类）</strong>：在抽象类中定义了一系列基本操作（Primitive Operations），这些基本操作可以是具体的，也可以是抽象的，每一个基本操作对应算法的一个步骤，在其子类中可以重定义或实现这些步骤。同时，在抽象类中实现了一个模板方法（Template Method），用于定义一个算法的框架，模板方法不仅可以调用在抽象类中实现的基本方法，也可以调用在抽象类的子类中实现的基本方法，还可以调用其他对象中的方法。</p></li> <li><p><strong>ConcreteClass（具体子类）</strong>：它是抽象类的子类，用于实现在父类中声明的抽象基本操作以完成子类特定算法的步骤，也可以覆盖在父类中已实现的具体基本操作。</p></li></ol> <h2 id="模板方法和基本方法"><a href="#模板方法和基本方法" aria-hidden="true" class="header-anchor">#</a> 模板方法和基本方法</h2> <p>在使用模板方法模式时，开发抽象类的软件设计师和开发具体子类的软件设计师之间可以进行协作。一个设计师负责给出一个算法的轮廓和框架，另外一些设计师则负责给出这个算法的各个逻辑步骤。实现这些具体逻辑步骤的方法即为基本方法，而将这些基本方法汇总起来的方法即为模板方法，模板方法模式的名字也因此而来，下面将详细介绍模板方法和基本方法。</p> <h3 id="_1-模板方法"><a href="#_1-模板方法" aria-hidden="true" class="header-anchor">#</a> 1.模板方法</h3> <p>一个模板方法是定义在抽象类中的，把基本操作方法组合在一起形成一个总算法或一个总行为的方法。这个模板方法定义在抽象类中，并由子类不加以修改地完全继承下来（在java语言中，可以将模板方法定义为final方法）。模板方法是一个具体方法，它给出了一个顶层逻辑框架，而逻辑的组成步骤在抽象类中可以是具体方法，也可以是抽象方法。由于模板方法是具体方法，因此模板方法模式中的抽象层只能是抽象类，而不是接口。</p> <h3 id="_2-基本方法"><a href="#_2-基本方法" aria-hidden="true" class="header-anchor">#</a> 2.基本方法</h3> <p>基本方法是实现算法各个步骤的方法，是模板方法的组成部分。基本方法又可以分成3中：<strong>抽象方法（Abstract Method），具体方法（Concrete Method）和钩子方法（Hook Method）</strong></p> <ul><li><p><strong>抽象方法</strong>：一个抽象方法由抽象类声明，由其具体子类实现。在java语言中一个抽象方法以abstract关键字标识</p></li> <li><p><strong>具体方法</strong>：一个具体方法由一个抽象类或具体类声明并实现，其子类可以进行覆盖也可以继承</p></li> <li><p><strong>钩子方法</strong>：一个钩子方法由一个抽象类或具体类声明并实现，而其子类可能会加以扩展。通常在父类中给出的实现是一个空实现，并以该实现作为方法的默认实现，当然钩子方法也可以提供一个非空的默认实现</p></li></ul> <p>在模板方法模式中，钩子方法有两类：第一类钩子方法可以与一些具体步骤‘挂钩’，以实现在不同条件下执行模板方法中的不同步骤，这类钩子方法的返回类型通常是boolean类型，这类方法名一般为isXXX(),用于对某个条件进行判断，如果条件满足则执行某一步骤，否则将不执行，代码片段如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	<span class="token punctuation">..</span><span class="token punctuation">..</span>
	//模板方法
	public void template<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		open<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		display<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		//通过钩子方法来确定某步骤是否执行
		if<span class="token punctuation">(</span>isPrint<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">{</span>
			print<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	//钩子方法
	public boolean isPrint<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>	
	<span class="token punctuation">}</span>
	<span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre></div><p>在以上代码中，isPrint()方法即是钩子方法，它可以决定print()方法是否执行，一般情况下，钩子方法的返回值为true,如果不希望某方法执行，可以在某子类中覆盖钩子方法，将其返回值改为false即可，这种类型的钩子方法可以控制方法的执行，对一个算法进行约束。</p> <p>还有一类钩子方法就是实现体为空的具体方法，子类可以根据需要覆盖或者继承这些钩子方法。与抽象方法相比，这类钩子方法的好处在于子类如果没有覆盖父类中定义的钩子方法，编译可以正常通过，但是如果没有覆盖父类中声明的抽象方法，编译将报错。</p> <p>模板方法模式中，抽象类的典型代码如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	abstract class AbstractClass<span class="token punctuation">{</span>
		//模板方法
		public void templateMethod<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			primitiveOperation1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			primitiveOperation2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			primitiveOperation3<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		//基本方法----具体方法
		public void primitiveOperation1（）<span class="token punctuation">{</span>
			//实现代码
		<span class="token punctuation">}</span>
		
		//基本方法----抽象方法
		public abstract void primitiveOperation2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		//基本方法----钩子方法
		public void primitiveOperation3<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>在抽象类中，模板方法templateMethod（）定义了算法的框架，在模板方法中调用基本方法以实现完整的算法，每一个基本方法如primitiveOperation1(),primitiveOperation2()等均实现了算法的一部分，对于所有子类都相同的基本方法可以在父类提供具体实现，例如primitiveOperation1（），否则在父类中声明为抽象方法或钩子方法，由不同的子类提供不同的实现，例如primitiveOperation2()，primitiveOperation3()</p> <p>可在抽象类的子类中提供抽象步骤的实现，也可覆盖父类中已经实现的具体方法，具体子类的经典代码如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	class ConcreteClass extends AbstractClass<span class="token punctuation">{</span>
		public void primitiveOperation2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			//实现代码
		<span class="token punctuation">}</span>
		public void primitiveOperation3<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			//实现代码
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> 
</code></pre></div><p>在模板方法模式中，由于面向对象的多态性，子类对象在运行时将覆盖父类对象，子类中定义的方法也将覆盖父类中定义的方法，因此程序在运行时，具体子类的基本方法将覆盖父类中定义的基本方法，子类的钩子方法也将覆盖父类的钩子方法，从而可以通过在子类中实现的钩子方法对父类方法的执行进行约束，实现子类对父类行为的反向控制。</p> <h2 id="实例：银行利息计算模块"><a href="#实例：银行利息计算模块" aria-hidden="true" class="header-anchor">#</a> 实例：银行利息计算模块</h2> <h3 id="设计结构图"><a href="#设计结构图" aria-hidden="true" class="header-anchor">#</a> 设计结构图</h3> <p><a data-fancybox="" title="结构图" href="/pic/design/PJQuylJ.png"><img src="/pic/design/PJQuylJ.png" alt="结构图"></a></p> <p>在图中,Account充当抽象类角色，CurrentAccount 和 SavingAccount充当具体子类角色。</p> <h3 id="代码实现："><a href="#代码实现：" aria-hidden="true" class="header-anchor">#</a> 代码实现：</h3> <p><strong>账号类：抽象方法</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>		public abstract class Account <span class="token punctuation">{</span>
		//基本方法-具体方法
		public boolean validate<span class="token punctuation">(</span>String account, String password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;账号：&quot;</span> + account<span class="token punctuation">)</span><span class="token punctuation">;</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;密码：&quot;</span> + password<span class="token punctuation">)</span><span class="token punctuation">;</span>
			if<span class="token punctuation">(</span>account.equalsIgnoreCase<span class="token punctuation">(</span><span class="token string">&quot;张无忌&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> password.equalsIgnoreCase<span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">))</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>else <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		//基本方法-抽象方法
		public abstract void calculateInterest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		//基本方法-具体方法
		public void display<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;显示利息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		//模板方法
		public void handle<span class="token punctuation">(</span>String account, String password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			if<span class="token punctuation">(</span><span class="token operator">!</span>validate<span class="token punctuation">(</span>account, password<span class="token punctuation">))</span> <span class="token punctuation">{</span>
				System.out.println<span class="token punctuation">(</span><span class="token string">&quot;账号或密码错误！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			calculateInterest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			display<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>活期账户类：具体子类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class CurrentAccount extends Account <span class="token punctuation">{</span>
	
		//覆盖父类的抽象基本方法
		public void calculateInterest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;按活期利率计算利息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>定期账户类：具体子类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class SavingAccount extends Account <span class="token punctuation">{</span>
	
		//覆盖父类的抽象基本方法
		public void calculateInterest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;按定期利率计算利息！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>该方法用于从XML配置文件中提取具体类类名，并返回一个实例对象</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class XMLUtil<span class="token punctuation">{</span>

		public static Object getBean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			try <span class="token punctuation">{</span>
				//创建对象
				DocumentBuilderFactory dFactory <span class="token operator">=</span> DocumentBuilderFactory.newInstance<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				DocumentBuilder builder <span class="token operator">=</span> dFactory.newDocumentBuilder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				Document doc<span class="token punctuation">;</span>
				doc <span class="token operator">=</span> builder.parse<span class="token punctuation">(</span>new File<span class="token punctuation">(</span><span class="token string">&quot;config.xml&quot;</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
				
				//获取包含类名的文本节点
				NodeList <span class="token function">nl</span> <span class="token operator">=</span> doc.getElementsByTagName<span class="token punctuation">(</span><span class="token string">&quot;className&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				Node classNode <span class="token operator">=</span> nl.item<span class="token punctuation">(</span>0<span class="token punctuation">)</span>.getFirstChild<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				String cName <span class="token operator">=</span> classNode.getNodeValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				
				//通过类名生成实例对象，并将其返回
				Class c <span class="token operator">=</span> Class.forName<span class="token punctuation">(</span>cName<span class="token punctuation">)</span><span class="token punctuation">;</span>
				Object obj <span class="token operator">=</span> c.newInstance<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> obj<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>catch <span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				e.printStackTrace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> null<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>配置文件config.xml中存储了具体子类的类名</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	<span class="token operator">&lt;</span>?xml version <span class="token operator">=</span> <span class="token string">&quot;1.0&quot;</span>?<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>config<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>className<span class="token operator">&gt;</span>CurrentAccount<span class="token operator">&lt;</span>/className<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>/config<span class="token operator">&gt;</span>
</code></pre></div><p><strong>客户端测试</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class Client <span class="token punctuation">{</span>
		public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			Account account<span class="token punctuation">;</span>
			account <span class="token operator">=</span> <span class="token punctuation">(</span>Account<span class="token punctuation">)</span> XMLUtil.getBean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			account.handle<span class="token punctuation">(</span><span class="token string">&quot;张无忌&quot;</span>, <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>如果需要更换子类，无需修改源代码，只需修改配置文件，如将配置文件config.xml中的CurrentAccount替换成SavingAccount即可。
如果需要加新的具体子类（新的账户类型），原有的代码无需修改，完全符合开闭原则。</p> <h2 id="钩子方法的使用"><a href="#钩子方法的使用" aria-hidden="true" class="header-anchor">#</a> 钩子方法的使用</h2> <p>模板方法模式不仅在父类中提供了一个定义算法框架的模板方法，还提供了一系列抽象方法，具体方法和钩子方法，其中钩子方法的引入使得子类可以控制父类的行为，如下实例</p> <h2 id="实例：数据图表的实现"><a href="#实例：数据图表的实现" aria-hidden="true" class="header-anchor">#</a> 实例：数据图表的实现</h2> <p>抽象父类：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	package com.zzk.templatemethodpattern2<span class="token punctuation">;</span>
	
	public abstract class DataViewer <span class="token punctuation">{</span>
		//抽象方法：获取数据
		public abstract void getData<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		//具体方法：转换数据
		public void convertData<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;将数据转换成XML格式&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		//抽象方法
		public abstract void displayData<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		//钩子方法：判断是否为XML格式的数据
		public boolean isNotXMLData<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		//模板方法
		public void process<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			getData<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			//如果不是XML格式的数据则进行数据转换
			if<span class="token punctuation">(</span>isNotXMLData<span class="token punctuation">(</span><span class="token punctuation">))</span> <span class="token punctuation">{</span>
				convertData<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			displayData<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>在上面的代码中，引入一个钩子方法isNotXMLData()，其返回类型为boolean类型，在模板方法中通过它来对数据转换方法convertData()进行约束，该钩子方法的默认返回值为true，在其子类可以根据情况覆盖方法，如下</p> <p><strong>具体子类实现：</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class SubDataViewer extends DataViewer <span class="token punctuation">{</span>
	
		//实现父类方法：获取数据
		public void getData<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;从XML文件中获取数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	
		//实现父类方法：显示数据
		public void displayData<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;以柱状图显示数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		//覆盖父类的钩子方法
		public boolean isNotXMLData<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2> <p>模板方法模式是一种<strong>基于继承的代码复用技术</strong>，它体现了面向对象的诸多思想，是一种使用频率较高的模式.模板方法模式广泛应用于框架设计（如Spring, JUnit等）中，以确保通过父类来控制处理流程的逻辑顺序（例如框架的初始化，测试流程的设置等）。</p> <h2 id="主要优点"><a href="#主要优点" aria-hidden="true" class="header-anchor">#</a> 主要优点</h2> <ol><li><p>模板方法模式在父类中形式化地定义一个算法，而由它的子类来实现细节的处理，在子类实现详细的处理算法时不会改变算法中步骤的执行次序。</p></li> <li><p>模板方法模式是一种代码复用技术，它在类库设计中尤为重要，它提取了类库中的公共行为，将公共行为放在父类中，而通过其子类来实现不同的行为，它鼓励恰当使用继承来实现代码复用。</p></li> <li><p>模板方法模式可实现一种反向控制结构，通过子类覆盖父类的钩子方法类决定某一特定步骤是否需要执行</p></li> <li><p>在模板方法模式中可以通过子类来覆盖父类的基本方法，不同的子类可以提基本方法的不同实现，更换和增加新的子类很方便，符合单一职责原则和开闭原则</p></li></ol> <h2 id="主要缺点"><a href="#主要缺点" aria-hidden="true" class="header-anchor">#</a> 主要缺点</h2> <p>需要为每一个基本方法的不同实现提供一个子类，如果父类中可变的基本方法太多，将会导致类的个数增加，系统更加庞大，设计也更加抽象，此时，可以结合<strong>桥接模式</strong>来设计。</p> <h2 id="适用场景"><a href="#适用场景" aria-hidden="true" class="header-anchor">#</a> 适用场景</h2> <ol><li><p>对一些复杂的算法进行分割，将其算法中固定不变的部分设计为模板方法和父类具体方法，而一些可以改变的细节由其子类来实现，即一次性地实现一个算法的不变部分，并将可变的行为留给子类来实现</p></li> <li><p>各个子类中公共的行为应被提取出来并集中到一个公共父类中以避免代码重复</p></li> <li><p>需要通过子类来决定父类算法中某个步骤是否执行，实现子类对父类的反向控制。</p></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/22/2020, 12:20:37 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/design/026_StrategyPattern.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        策略模式
      </a></span> <span class="next"><a href="/design/028_VisitorPattern.html">
        访问者模式
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.193c9b61.js" defer></script><script src="/assets/js/2.be286493.js" defer></script><script src="/assets/js/43.dbe26f4f.js" defer></script>
  </body>
</html>