<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>中介者模式 | Koala &#39;s blog</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <meta name="description" content="欢迎来到我的博客">
    <link rel="preload" href="/assets/css/0.styles.0dca6718.css" as="style"><link rel="preload" href="/assets/js/app.193c9b61.js" as="script"><link rel="preload" href="/assets/js/2.be286493.js" as="script"><link rel="preload" href="/assets/js/37.f105831d.js" as="script"><link rel="prefetch" href="/assets/js/10.d195f939.js"><link rel="prefetch" href="/assets/js/11.dd42e2a6.js"><link rel="prefetch" href="/assets/js/12.ee2c872c.js"><link rel="prefetch" href="/assets/js/13.788181fe.js"><link rel="prefetch" href="/assets/js/14.923b40d7.js"><link rel="prefetch" href="/assets/js/15.be1e8f2a.js"><link rel="prefetch" href="/assets/js/16.a5861f2e.js"><link rel="prefetch" href="/assets/js/17.0ca1cca8.js"><link rel="prefetch" href="/assets/js/18.3552af88.js"><link rel="prefetch" href="/assets/js/19.d0b598dd.js"><link rel="prefetch" href="/assets/js/20.312fba46.js"><link rel="prefetch" href="/assets/js/21.de99e5de.js"><link rel="prefetch" href="/assets/js/22.4cb1ef09.js"><link rel="prefetch" href="/assets/js/23.2e9ea85a.js"><link rel="prefetch" href="/assets/js/24.1cd100b8.js"><link rel="prefetch" href="/assets/js/25.c17ed571.js"><link rel="prefetch" href="/assets/js/26.cee42a14.js"><link rel="prefetch" href="/assets/js/27.34b9e8bb.js"><link rel="prefetch" href="/assets/js/28.a0fd1666.js"><link rel="prefetch" href="/assets/js/29.cc16a8ba.js"><link rel="prefetch" href="/assets/js/3.e2b53d75.js"><link rel="prefetch" href="/assets/js/30.4b4a9808.js"><link rel="prefetch" href="/assets/js/31.55d17ac2.js"><link rel="prefetch" href="/assets/js/32.e6285297.js"><link rel="prefetch" href="/assets/js/33.2cf9fcd0.js"><link rel="prefetch" href="/assets/js/34.549b5096.js"><link rel="prefetch" href="/assets/js/35.fd8c8f14.js"><link rel="prefetch" href="/assets/js/36.db162c08.js"><link rel="prefetch" href="/assets/js/38.d42b82e0.js"><link rel="prefetch" href="/assets/js/39.eb81783f.js"><link rel="prefetch" href="/assets/js/4.2837b6be.js"><link rel="prefetch" href="/assets/js/40.87c4c789.js"><link rel="prefetch" href="/assets/js/41.fc9b4279.js"><link rel="prefetch" href="/assets/js/42.c9148681.js"><link rel="prefetch" href="/assets/js/43.dbe26f4f.js"><link rel="prefetch" href="/assets/js/44.b1d85a5c.js"><link rel="prefetch" href="/assets/js/45.5a1e6a7a.js"><link rel="prefetch" href="/assets/js/46.bd963e4a.js"><link rel="prefetch" href="/assets/js/47.f6e86edc.js"><link rel="prefetch" href="/assets/js/48.bdbc5c65.js"><link rel="prefetch" href="/assets/js/49.65ae461d.js"><link rel="prefetch" href="/assets/js/5.3f71247d.js"><link rel="prefetch" href="/assets/js/50.66be60b2.js"><link rel="prefetch" href="/assets/js/51.42b1c641.js"><link rel="prefetch" href="/assets/js/52.bb9f5b94.js"><link rel="prefetch" href="/assets/js/53.3ed95f43.js"><link rel="prefetch" href="/assets/js/54.b989fa99.js"><link rel="prefetch" href="/assets/js/55.7799c2bd.js"><link rel="prefetch" href="/assets/js/56.95e3d2fa.js"><link rel="prefetch" href="/assets/js/57.47649eef.js"><link rel="prefetch" href="/assets/js/58.c3ce9734.js"><link rel="prefetch" href="/assets/js/59.1e092fb4.js"><link rel="prefetch" href="/assets/js/6.ba15ebf3.js"><link rel="prefetch" href="/assets/js/60.ae57b5f2.js"><link rel="prefetch" href="/assets/js/61.68ecf247.js"><link rel="prefetch" href="/assets/js/62.42a2fc04.js"><link rel="prefetch" href="/assets/js/63.819b8db9.js"><link rel="prefetch" href="/assets/js/64.8034f4d3.js"><link rel="prefetch" href="/assets/js/65.fa291912.js"><link rel="prefetch" href="/assets/js/66.3db4dcf7.js"><link rel="prefetch" href="/assets/js/67.a66d7e55.js"><link rel="prefetch" href="/assets/js/68.cbaf17d3.js"><link rel="prefetch" href="/assets/js/7.6f9d368d.js"><link rel="prefetch" href="/assets/js/8.516fa0e1.js"><link rel="prefetch" href="/assets/js/9.f1946ce5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0dca6718.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container custom-page-class"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active no-logo home-link"><!----> <span class="site-name">Koala 's blog</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          Home
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/design/" class="router-link-active">
          设计模式
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/algorithm/">
          算法相关
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          java相关
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/design/001_Preface.html" class="sidebar-link">前言</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>创建者模式</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>结构性模式</span> <span class="arrow right"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>行为性模式</span> <span class="arrow down"><i aria-label="icon: down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></i></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/017_BehavioralPattern.html" class="sidebar-link">介绍</a></li><li><a href="/design/018_ChainofResponsibilityPattern.html" class="sidebar-link">职责链模式</a></li><li><a href="/design/019_CommandPattern.html" class="sidebar-link">命令模式</a></li><li><a href="/design/020_InterpreterPattern.html" class="sidebar-link">解释器模式</a></li><li><a href="/design/021_MediatorPattern.html" class="active sidebar-link">中介者模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#概述" class="sidebar-link">概述</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#结构图" class="sidebar-link">结构图</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#职责" class="sidebar-link">职责</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#典型代码" class="sidebar-link">典型代码</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#代码实例" class="sidebar-link">代码实例</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#中介者和同事类的扩展" class="sidebar-link">中介者和同事类的扩展</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#缺点" class="sidebar-link">缺点</a></li><li class="sidebar-sub-header"><a href="/design/021_MediatorPattern.html#适用场景" class="sidebar-link">适用场景</a></li></ul></li><li><a href="/design/022_MementoPattern.html" class="sidebar-link">备忘录模式</a></li><li><a href="/design/023_IteratorPattern.html" class="sidebar-link">迭代器模式</a></li><li><a href="/design/024_ObserverPattern.html" class="sidebar-link">观察者模式</a></li><li><a href="/design/025_StatePattern.html" class="sidebar-link">状态模式</a></li><li><a href="/design/026_StrategyPattern.html" class="sidebar-link">策略模式</a></li><li><a href="/design/027_Template_Method_Pattern.html" class="sidebar-link">模板方法模式</a></li><li><a href="/design/028_VisitorPattern.html" class="sidebar-link">访问者模式</a></li></ul></section></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h2 id="概述"><a href="#概述" aria-hidden="true" class="header-anchor">#</a> 概述</h2> <p>如果一个系统中对象之间的联系呈现出网状结构，如图所示，对象之间存在大量的多对多联系，将导致系统非常复杂，这些对象既会影响别的对象，也会被别的对象所影响，这些对象称为同事对象，它们之间通过彼此的相互作用实现系统的行为。在网状结构中，几乎每个对象都需要与其他对象发生相互作用，而这种相互作用表现为一个对象与另外一个对象的直接耦合，这将导致一个过度耦合的系统。</p> <p>中介者模式可以使对象之间的关系数量急剧减少，通过引入中介者对象，可以将系统的网状结构变成以中介者为中心的星性结构，如图2所示。在在这个星型结构中，同事对象不再直接与另一个对象联系，它通过中介者对象与另一个对象发生相互作用。中介者对象的存在保证了对象结构上的稳定，也就是，系统的结构不会因为新对象的引入带来大量的修改工作。</p> <p>如果在一个系统中对象之间存在多对多的相互关系，可以将对象之间的一些交互行为从各个对象中分离出来，并集合封装在一个中介者对象中，并由该中介者进行统一协调，这样对象之间多对多的复杂关系就转化为相对简单的一对多的关系。通过引入中介者来简化对象之间的复杂交互，中介者模式是迪米特法则的一个典型应用。</p> <h2 id="定义"><a href="#定义" aria-hidden="true" class="header-anchor">#</a> 定义</h2> <blockquote><p>中介者模式（Mediator Pattern）： 用一个中介对象（中介者）来封装一系列的对象交互，中介者模式使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间地交互。<strong>中介者模式又称为调停者模式，它是一种对象行为型模式。</strong></p></blockquote> <h2 id="结构图"><a href="#结构图" aria-hidden="true" class="header-anchor">#</a> 结构图</h2> <p><a data-fancybox="" title="结构图" href="/pic/design/3ORNFSz.png"><img src="/pic/design/3ORNFSz.png" alt="结构图"></a></p> <ol><li><p><strong>Medistor（抽象中介者）</strong>：它定义一个接口，该接口用于与各同事对象之间进行通信。</p></li> <li><p><strong>ConcreteMediator（抽象中介者）</strong>： 它是抽象中介者的子类，通过协调各个同事对象来实现协作行为，维持了各个同事对象的引用。</p></li> <li><p><strong>Colleague（抽象同事类）</strong>：它定义各个同事类公有的方法，并声明了一些抽象方法来供子类实现，同时维持了一个对抽象中介者类的引用，其子类可以通过该引用来与中介者通信</p></li> <li><p><strong>ConcreteColleague（具体同事类）</strong>：它是抽象同事类的子类，每一个同事对象在需要和其他同事对象通信时，先与中介者通信，通过中介者类来间接完成与其他同事类的通信；在具体同事类中实现了在抽象同事类中声明的抽象方法。</p></li></ol> <h2 id="职责"><a href="#职责" aria-hidden="true" class="header-anchor">#</a> 职责</h2> <p><strong>中介者模式的核心在于中介者类的引入，在中介者模式中，中介者类承担了以下两方面的职责：</strong></p> <ol><li><p><strong>中转作用（结构性）</strong>。通过中介者提供的中转作用，各个同事对象就不再需要显式地引用其他同事，当需要和其他同事进行通信时，可通过中介者来实现间接调用。该中转作用属于中介者在结构上的支持。</p></li> <li><p><strong>协调作用（行为性）</strong>。中介者可以更进一步地对同事之间地关系进行封装，同事可以一致地和中介者进行交互，而不需要指明中介者需要具体怎么做，中介者根据封装在自身内部地协调逻辑，对同事地请求进一步处理，将同事成员之间的关系行为进行分离和封装。该协调作用属于中介者在行为上的支持</p></li></ol> <h2 id="典型代码"><a href="#典型代码" aria-hidden="true" class="header-anchor">#</a> 典型代码</h2> <p>典型的抽象中介者类代码如下</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	abstract class Mediator<span class="token punctuation">{</span>
			
		protected ArrayList<span class="token operator">&lt;</span>Colleague<span class="token operator">&gt;</span> colleagues<span class="token punctuation">;</span>   //用于存储同事对象

		//注册方法，用于增加同事对象
		public void register<span class="token punctuation">(</span>Colleague colleague<span class="token punctuation">)</span>
			colleagues.add<span class="token punctuation">(</span>colleague<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		//声明抽象的业务方法
		public abstract void operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>在抽象中介者中可以定义一个同事类的集合，用于存储同事对象并提供注册方法，同时声明具体中介者类所具有的方法。在具体中介者类中将实现这些抽象方法，典型的具体中介者类代码如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	class ConcreteMediator extends Mediator<span class="token punctuation">{</span>
		//实现业务方法，封装同事之间的调用
		public void operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token punctuation">..</span><span class="token punctuation">..</span>
			<span class="token variable"><span class="token punctuation">((</span>Colleague<span class="token punctuation">)</span><span class="token punctuation">(</span>colleagues.get<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">))</span></span><span class="token punctuation">)</span>.method1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>//通过中介者调用同事类的方法
			<span class="token punctuation">..</span><span class="token punctuation">..</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>在具体中介者类中将调用同事类的方法，调用时可以增加一些自己的业务代码对调用进行控制。</p> <p>在抽象同事类中维持了一个抽象中介者的引用，用于调用中介者的方法，典型的抽象同事类代码如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	abstract class Colleague<span class="token punctuation">{</span>
		
		protected Mediator mediator<span class="token punctuation">;</span>    //维持一个抽象中介者的引用
		
		public Colleague<span class="token punctuation">(</span>Mediator mediator<span class="token punctuation">)</span><span class="token punctuation">{</span>
			this.mediator <span class="token operator">=</span> mediator<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>	
		
		public abstract void method<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //声明自身的方法，处理自己的行为
		
		//定义依赖方法，与中介者进行通信
		public void method2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			mediator.operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>在抽象同事类中声明了同事类的抽象方法，而在具体同事类中将实现这些方法，典型的具体同事类代码如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>	class ConcreteColleague extends Colleague<span class="token punctuation">{</span>
		public ConcreteColleague <span class="token punctuation">(</span>Mediator mediator<span class="token punctuation">)</span><span class="token punctuation">{</span>
			super<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		//实现自身的方法
		public void method<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p>在具体同事类ConcreteColleague中实现了在抽象同事类中声明的方法，其中方法method()时同事类的自身方法(Self-Method),用于处理自己的行为，而方法method2()是依赖方法（Depend-Method），用于调用在中介者中定义的方法，依赖中介者来完成相应的行为，例如调用另外一个同事类的相关方法。</p> <h2 id="代码实例"><a href="#代码实例" aria-hidden="true" class="header-anchor">#</a> 代码实例</h2> <p>为了协调界面组件对象之间的复杂交互关系，Sunny公司开发人员使用中介者模式来设计客户信息管理窗口</p> <h3 id="结构图-2"><a href="#结构图-2" aria-hidden="true" class="header-anchor">#</a> 结构图</h3> <p><a data-fancybox="" title="结构图" href="/pic/design/OvNo3WE.png"><img src="/pic/design/OvNo3WE.png" alt="结构图"></a></p> <p>Component充当抽象同事类，Button，List，ComboBox和TextBox充当具体同事类，Mediator充当抽象中介者类，ConcreteMediator充当具体中介者类，ConcreteMediator维持了对具体同事类的引用，为了简化ConcreteMediator类的代码，在其中只定义了一个Button对象和一个TextBox对象</p> <h3 id="代码实现"><a href="#代码实现" aria-hidden="true" class="header-anchor">#</a> 代码实现</h3> <p><strong>抽象中介者</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public abstract class Mediator <span class="token punctuation">{</span>
		public abstract void componentChanged<span class="token punctuation">(</span>Component c<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>具体中介者</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class ConcreteMediator extends Mediator <span class="token punctuation">{</span>
	
		//维持对各个同事对象的引用
		public Button addButton<span class="token punctuation">;</span>
		public List list<span class="token punctuation">;</span>
		public TextBox userNameTextBox<span class="token punctuation">;</span>
		public ComboBox cb<span class="token punctuation">;</span>
		
		//封装同事对象之间的交互
		public void componentChanged<span class="token punctuation">(</span>Component c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			//单击按钮
			if<span class="token punctuation">(</span>c <span class="token operator">==</span> addButton<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				System.out.println<span class="token punctuation">(</span><span class="token string">&quot;---单击增加按钮---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				list.update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				cb.update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				userNameTextBox.update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			//从列表框选择客户
			<span class="token keyword">else</span> if<span class="token punctuation">(</span>c <span class="token operator">==</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				System.out.println<span class="token punctuation">(</span><span class="token string">&quot;---从列表框选择客户---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				cb.select<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				userNameTextBox.setText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>抽象组件类：抽象同事类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public abstract class Component <span class="token punctuation">{</span>
		protected Mediator mediator<span class="token punctuation">;</span>
		
		public void setMediator<span class="token punctuation">(</span>Mediator mediator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			this.mediator <span class="token operator">=</span> mediator<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		//转发调用
		public void changed<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			mediator.componentChanged<span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		public abstract void update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>按钮类：具体同事类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class Button extends Component <span class="token punctuation">{</span>
		public void update<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			//按钮不产生响应
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>列表框类：具体同事类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class List extends Component <span class="token punctuation">{</span>
	
		public void update<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;列表框增加一项：张无忌&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		public void select<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;列表框选中项：小龙女&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>组合框类：具体同事类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class ComboBox extends Component <span class="token punctuation">{</span>
	
		@Override
		public void update<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;组合框增加一项：张无忌&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		public void select<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;组合框选中框：小龙女&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>文本框：具体同事类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class TextBox extends Component <span class="token punctuation">{</span>
	
		@Override
		public void update<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;客户信息增加成功后文本框清空&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		public void setText<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;文本框显示：小龙女&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>客户端</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class Client <span class="token punctuation">{</span>
		public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			//定义中介者对象
			ConcreteMediator mediator<span class="token punctuation">;</span>
			mediator <span class="token operator">=</span>new ConcreteMediator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			//定义同事对象
			Button addBT <span class="token operator">=</span> new Button<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			List list <span class="token operator">=</span> new List<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			ComboBox cb <span class="token operator">=</span> new ComboBox<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			TextBox userNameTB <span class="token operator">=</span> new TextBox<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			addBT.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			list.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			cb.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			userNameTB.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			mediator.addButton <span class="token operator">=</span> addBT<span class="token punctuation">;</span>
			mediator.list <span class="token operator">=</span> list<span class="token punctuation">;</span>
			mediator.cb <span class="token operator">=</span> cb<span class="token punctuation">;</span>
			mediator.userNameTextBox <span class="token operator">=</span> userNameTB<span class="token punctuation">;</span>
			
			addBT.changed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;---------------------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			list.changed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="中介者和同事类的扩展"><a href="#中介者和同事类的扩展" aria-hidden="true" class="header-anchor">#</a> 中介者和同事类的扩展</h2> <p>需要在原有的系统上，<strong>增加一个新的组件Label（即新的同事类）</strong>，有以下两种方案：</p> <ol><li><p>增加一个组件类Label，修改原有的具体中介者ConcreteMeditator，增加一个对Label对象的引用，然后修改componentChanged()方法中其他组件对象的业务修改代码，原有组件类无需任何修改，客户端代码也需针对新增的组件Label进行适当的修改</p></li> <li><p>与方案1一样，首先增加一个Label类，但不修改原有具体中介者类ConcreteMediator的代码，而是增加一个ConcreteMediator的子类SubConcreteMediator来实现对Label对象的引用，然后在新增的中介者SubConcreteMediator中通过覆盖component Changed()方法来实现所有组件(包括新增Label组件)之间的交互，同样，原有组件类无需做任何修改，客户端代码只需少许修改</p></li></ol> <h3 id="类结构图"><a href="#类结构图" aria-hidden="true" class="header-anchor">#</a> 类结构图</h3> <p>引入Label之后，类结构图如下：</p> <p><a data-fancybox="" title="结构图" href="/pic/design/fHpPrTQ.png"><img src="/pic/design/fHpPrTQ.png" alt="结构图"></a></p> <p>由于方案2无需修改ConcreteMediator类，更加符合开闭原则，因此选择方案2对新增Label类进行修改，如下</p> <h3 id="代码实现-2"><a href="#代码实现-2" aria-hidden="true" class="header-anchor">#</a> 代码实现</h3> <p><strong>文本标签类：具体同事类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class Label extends Component<span class="token punctuation">{</span>
	
		@Override
		public void update<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;文本标签内容改变，客户信息总数加1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>新增具体中介者类</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class SubConcreteMediator extends ConcreteMediator <span class="token punctuation">{</span>
		
		//增加对Label对象的引用
		public Label label<span class="token punctuation">;</span>
		
		@Override
		public void componentChanged<span class="token punctuation">(</span>Component c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			//单击按钮
			if<span class="token punctuation">(</span>c <span class="token operator">==</span> addButton<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				System.out.println<span class="token punctuation">(</span><span class="token string">&quot;---单击增加按钮---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				list.update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				cb.update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				userNameTextBox.update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				label.update<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		//文本
			<span class="token punctuation">}</span>
			//从列表框选择客户
			<span class="token keyword">else</span> if<span class="token punctuation">(</span>c <span class="token operator">==</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				System.out.println<span class="token punctuation">(</span><span class="token string">&quot;---从列表框选择客户---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				cb.select<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				userNameTextBox.setText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>客户端测试</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>	public class Client <span class="token punctuation">{</span>
		public static void main<span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			//用新增具体中介者定义中介者对象
			SubConcreteMediator mediator<span class="token punctuation">;</span>
			mediator <span class="token operator">=</span> new SubConcreteMediator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			Button addBT <span class="token operator">=</span> new Button<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			List list <span class="token operator">=</span> new List<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			ComboBox cb <span class="token operator">=</span> new ComboBox<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			TextBox userNameTB <span class="token operator">=</span> new TextBox<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Label label <span class="token operator">=</span> new Label<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			addBT.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			list.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			cb.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			userNameTB.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			label.setMediator<span class="token punctuation">(</span>mediator<span class="token punctuation">)</span><span class="token punctuation">;</span>
			
			mediator.addButton <span class="token operator">=</span> addBT<span class="token punctuation">;</span>
			mediator.list <span class="token operator">=</span> list<span class="token punctuation">;</span>
			mediator.cb <span class="token operator">=</span> cb<span class="token punctuation">;</span>
			mediator.userNameTextBox <span class="token operator">=</span> userNameTB<span class="token punctuation">;</span>
			mediator.label <span class="token operator">=</span> label<span class="token punctuation">;</span>
			
			addBT.changed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			System.out.println<span class="token punctuation">(</span><span class="token string">&quot;-----------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			list.changed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	
	<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>在中介者模式的实际使用过程中，如果需要引入新的具体同事类，只需要继承抽象同事类并实现其中的方法即可，由于具体同事类之间并无直接的引用关系，因此原有所有同事类无需进行任何修改，它们与新增同事对象之间的交互可以通过修改或者增加具体中介者类来实现；如果需要在原有系统中增加新的具体中介者类，只需要继承抽象类（或者已有的具体中介者类）并覆盖其中定义的方法即可，在新的具体中介者中可以通过不同的方式来处理对象之间的交互，也可以增加对新增同事的引用和调用。在客户端中只需要修改少许代码（如果引入配置文件的话有时可以不修改任何代码）就可以实现中介者的更换。</p></blockquote> <h2 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h2> <p>中介者模式将一个网状的系统结构变成一个以中介者对象为中心的星型结构，在这个星型结构中，使用中介者对象和其他对象的一对多关系来取代原有对象之间的多对多关系。中介者模式在事件驱动类软件中应用较为广泛，特别是基于GUI的软件。此外，在类与类之间存在错综复杂的关联关系的系统中，中介者模式都得到较好的应用。</p> <h2 id="优点"><a href="#优点" aria-hidden="true" class="header-anchor">#</a> 优点</h2> <ol><li><p>中介者模式简化了对象之间的交互，它用了中介者和同事的一对多交互代替了原来同事之间的多对多交互，一对多关系更容易理解，维护和扩展，将原本难以理解的网状结构转换成相对简单的星型结构</p></li> <li><p>中介者模式可将个同事对象解耦。中介者有利于各同事之间的松耦合，可以独立地改变和复用每一个同事和中介者，增加新的中介者和新的同事类都比较方便，更加符合开闭原则</p></li> <li><p>可以大量减少同事子类生成，中介者将分布于多个对象间地行为集中在一起，改变这些行为只需要生成新的中介者子类即可，这使得各个同事类可以被重用，无需对同事类进行扩展。</p></li></ol> <h2 id="缺点"><a href="#缺点" aria-hidden="true" class="header-anchor">#</a> 缺点</h2> <p>在具体中介者类中包含了大量同事之间地交互细节，可能会导致具体中介者类非常复杂，使得系统难以维护。</p> <h2 id="适用场景"><a href="#适用场景" aria-hidden="true" class="header-anchor">#</a> 适用场景</h2> <ol><li><p>系统中对象之间存在复杂地引用关系，系统结构混乱并且难以理解</p></li> <li><p>一个对象由于引用了其他很多对象并且直接和这些对象通信，导致难以复用该对象。</p></li> <li><p>想通过一个中间类来封装多个类中地行为，而又不想生成太多的子类。可以通过引入中介者类来实现，在中介者中定义对象交互的公共行为，如果改变行为则可以增加新的具体中介者类。</p></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">9/22/2020, 12:20:37 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/design/020_InterpreterPattern.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        解释器模式
      </a></span> <span class="next"><a href="/design/022_MementoPattern.html">
        备忘录模式
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.193c9b61.js" defer></script><script src="/assets/js/2.be286493.js" defer></script><script src="/assets/js/37.f105831d.js" defer></script>
  </body>
</html>